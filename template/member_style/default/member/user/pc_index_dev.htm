<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>{$info.username}的主页</title>
	<link rel="stylesheet" href="__STATIC__/css/base.css">
	<link rel="stylesheet" href="__STATIC__/icon/icon.css">
	<script type="text/javascript" src="__STATIC__/js/core/jquery.min.js"></script>
	<script type="text/javascript" src="__STATIC__/layer/layer.js"></script>
</head>
<style type="text/css">
.user_banner{height:260px;background:#eee;overflow:hidden;}
.user_banner .banner-img{width: 100%;height:100%;overflow: hidden;background-repeat: no-repeat;}
.user-logo-num{height:75px;margin:0 auto;width:1000px;padding-top:12px;}
.user-logo-num .data-list-box{width:200px;float:left;text-align:center;position:relative;color:#999;font-size:16px;}
.user-logo-num .data-list-box p{font-size:24px;font-weight:700;color:#333;padding-top:5px;}
.user-logo-num .right{float:right;}
.user-logo-num .imgs{width:140px;height:75px;margin:0 auto;position:relative;}
.user-logo-num .user-icon{display:block;width:140px;height:140px;border:3px #fff solid;border-radius:50%;position:absolute;top:-80px;left:0;}
.infomation-users{text-align:center;margin-top:15px;margin-bottom:35px;background:#fff;}
.infomation-users .nick-name{font-size:22px;color:#444;}
.infomation-users .nick-vip{padding-top:5px;color:#999;font-size:14px;}
.infomation-users .nick-sort{color:#666;font-size:14px;margin-top:20px;line-height:20px;}
.infomation-users .nick-msg{margin-top:20px;}
.infomation-users .nick-msg .msg-btn{display:inline-block;width:120px;height:35px;
	line-height:35px;font-size:14px;text-align:center;color:#666;border-radius:5px;
	 border: 1px solid #bbb;margin-right:10px;background:#fff;}
.infomation-users .nick-msg .guanzhu{background:red;color:#fff;border: 1px solid red;}
.infomation-users .nick-msg i{font-size:18px;padding-right:5px;position:relative;top:3px;color:#999;}
/***切换**/
.ContentType-box{padding-bottom:10px;overflow:hidden;padding-top:10px;}
.ContentType-box .Showtab{height:50px;position: relative;font-size:18px;
	text-align:center;border-bottom:1px #ddd solid;line-height:50px;
}
.ContentType-box .Showtab span{position: relative;padding:0 30px;color:#666;height:50px;display:inline-block;cursor:pointer;}
.ContentType-box .Showtab span.ck{color: #EF0E0E;}
.ContentType-box .Showtab span.ck:after{content: '';display: block;position: absolute;width: 100%;height: 2px;background: #EF0E0E;left: 0px;bottom: 0px;}
.ContentType-box .Contents2{width:1400px;margin-top:25px;overflow:hidden;}
.content-width{width:100%;padding-bottom:10px;overflow:hidden;background:#f7f7f7;}
.member-moban{margin:0 auto;overflow:hidden;width:1380px;}
.member-moban .list{background:#fff;overflow:hidden;float:left;width:314px;padding:8px;
	margin:0 20px 20px 0;}
.member-moban .list .pic{width: 100%;height:0;padding-top:75%;
    overflow: hidden;background-repeat: no-repeat;}
.member-moban .list .title{font-size:15px;height:40px;line-height:20px;overflow:hidden;margin-top:10px;color:#666;text-align:center;}
.member-moban .list .price{margin-top:12px;height:40px;padding:0 20px;}
.member-moban .list .price .p1{font-size:20px;color:red;float:left;font-weight:700;}
.member-moban .list .price .p1 em{font-size:14px;padding-right:3px;color:#999;font-weight:normal;;}
.member-moban .list .price .p2{float:right;color:#999;font-size:14px;padding-top:2px;}
.member-moban .list .times{border-top:1px #eee solid;text-align:center;padding-top:8px;font-size:14px;color:#888;}
.member-bbslist .listitem{float:left;width:660px;margin:0px 15px 8px 0;overflow:hidden;padding:10px;background:#fff;}
.member-bbslist .listitem .text{font-size:16px;color:#333;height:26px;overflow:hidden;}
.member-bbslist .listitem .text em{padding:2px 5px;color:#333;font-weight:700;margin-right:5px;background:#eee;}
.member-bbslist .listitem .others{margin-top:5px;}
.member-bbslist .listitem .others .left{float:left;}
.member-bbslist .listitem .others .left em{padding-left:5px;}
.member-bbslist .listitem .others .right{float:right;}
.member-bbslist .listitem p{float:left;font-size:14px;padding-right:20px;color:#999;}
.member-bbslist .listitem p i{padding-right:5px;}
.member-bbslist .listitem span{height:15px;padding:2px 5px;color: #fff;font-size:14px;margin-right:4px;}
.member-bbslist .listitem .ding{background:#0CCCCE;}
.member-bbslist .listitem .hot{background:red;}
.member-bbslist .listitem .jing{background:#4DA6FF;}
.member-bbslist .listitem .new{background:#FF9900;}
.user-infomation{background:#fff;border-radius:10px;margin:0 auto;}
.user-infomation dl{background:#fff;}
.user-infomation dl dt{padding-bottom:5px;border-bottom:1px #eee solid;font-weight:700;}
.user-infomation dl dd{font-size:14px;padding:10px 0;overflow:hidden;}
.user-infomation dl dd p{width:70px;float:left;color:#999;padding-right:10px;display:inline-block;}
.user-infomation dl dd span{float:left;width:800px;}
#top_banner{width:1px;position:fixed;top:-10px;overflow:hidden;}
</style>
<body style="background:#fff;">
<script type="text/javascript">
function load_banner(){
	var imgobj = $(".banner-img img");
	var picurl = imgobj.attr('src');
	$(".banner-img").css({"background-image":"url("+picurl+")"});
	$(".user_banner").css({"height":imgobj.height()+"px"});
}
</script>
<div class="user_banner">
	<div class="banner-img" style="background-position: center center;"><div style="width:1px;height:1px;overflow:hidden;"><img style="border:10px solid #000;" src="{$info.pc_banner}" onload="load_banner();" onerror="this.src='__STATIC__/qibo/pc_home_banner.jpg';load_banner();"/></div></div>
</div>
<div class="user-logo-num">
	<div class="data-list-box">
		总收入
		<p>￥{:sprintf("%01.2f",fun("Count@sum","rmb_getout",$info.uid,'money')+$info.rmb)}</p>
	</div>
	<div class="data-list-box">
		积分
		<p>{$info.money}</p>
	</div>
	<div class="data-list-box">
		<div class="imgs">
		<img src="{$info.icon|tempdir}" onerror="this.src='__STATIC__/images/nobody.gif'" class="user-icon">
	   </div>
	</div>
	<div class="data-list-box">
		人气
		<p>{$info.view}</p>
	</div>
	<div class="data-list-box">
		粉丝
		<p id="myfans_num">{:fun('Count@Info','friend',['suid'=>$info['uid']])}</p>
	</div>
</div>
<script type="text/javascript">
$(function(){
	
	var that = $("#ckguanzhu");
	//检查是否已关注
	$.get("{:murl('member/wxapp.friend/ckgz',['uid'=>$uid])}",function(res){
		if(res.code==1){	//还没关注
			that.click(function(){	//添加关注点击事件
				$.get("{:murl('member/wxapp.friend/add',['uid'=>$uid])}",function(res){
					if(res.code==0){	//关注成功
						layer.msg('关注成功');
						that.html('已关注');
					}else{	//关注失败
						layer.alert(res.msg);
					} 
				});						
			});
		}else if(res.code==0){	//已关注
			that.click(function(){
				$.get("{:murl('member/wxapp.friend/del',['uid'=>$uid])}",function(res){
					if(res.code==0){	//取消关注
						layer.msg('成功取消关注');
						that.html('已取消关注');
					}else{	//取消失败
						layer.alert(res.msg);
					} 
				});
			})			
			that.html('-取消关注');
		}
	});
})
</script>
<!--user---->
<div class="infomation-users">
	<p class="nick-name">{$info.username}</p>
	<p class="nick-vip">{$info.groupid|getGroupByid}</p>
	{if $info.introduce}<p class="nick-sort">个人简介：{$info.introduce}</p>{/if}
	<div class="nick-msg">
		<div class="msg-btn guanzhu" id="ckguanzhu">+加关注</div>
		<div class="msg-btn"><a href="{:url('member/msg/add',['uid'=>$info['uid']])}"><i class="si si-envelope"></i>私信</a></div>
		<div class="msg-btn"><a href="#" class="myqunzi">TA的圈子</a></div>
	</div>
</div>

<script type="text/javascript">
$(function(){
	var obj = $(".myqunzi");
	$.get("{:iurl('qun/wxapp.qun/mycreate')}?uid={$info.uid}",function(res){
		if(res.code==0){
			var qunurl = "{:iurl('qun/content/show')}?id=";
			if(res.data.length==1){
				obj.attr("target","_blank");
				obj.attr("href",qunurl+res.data[0].id);		
				return ;
			}else{
				if(res.data.length>0){					
					obj.click(function(){
						var qun = new Array();
						$.each(res.data,function(i,rs){
							qun.push("<a style='color:#fff;' target='_blank' href='" + qunurl + rs.id + "'>"+rs.title+"</a>");
						});
						layer.tips( qun.join('<br>'), obj , {tips: [3, '#0FA6D8'],tipsMore: false,time:5000 });
					});
					return ;
				}
			}
		}
		obj.click(function(){
			layer.alert('TA还没有创建任何圈子!');
		});
	});	
});
</script>

<!--列表开始---->
 <div class="ContentType-box">
     <div class="Showtab">
      <span class="ck">发布的应用</span>
      <span>发表的主题</span>
      <span>回复的主题</span>
      <span>基本信息</span>
     </div>
  <div class="content-width">
  	<div class="member-moban">
  	<div class="Contents2 pc_member_homepage_dev001">
     {qb:tag name="pc_member_homepage_dev001" js="pc_member_homepage_dev001" union="uid" type="appstore" mid="-1" rows="8" order="id" by="desc"}
	 <a href="{$rs.url}" target="_blank">
	  <div class="list">
	   	<div class="pic" style="background:url({$rs.picurl});background-size:cover; background-position: center center;"></div>
	   	<div class="title">{$rs.title}</div>
	   	<div class="price">
	   		<p class="p1" style="font-size: 14px;"><em>售价:</em>￥{$rs.price}
			{if $rs.vip_price>0}<em> vip尊享:</em><span style="color:orange;">{$rs.vip_price}</span>{/if}
			</p>
	   		<p class="p2">{$rs.downs}次安装</p>
	   	</div>
	   	<div class="times">更新时间：{$rs.appupdate_time|date="Y-m-d H:i",###}</div>
	   </div>
	   </a>
	{/qb:tag}
    </div>
  </div>
<div class="member-moban">
 <div class="Contents2 member-bbslist pc_member_homepage_dev002" style="display:none;">
       {qb:tag name="pc_member_homepage_dev002" js="pc_member_homepage_dev002" union="uid" type="bbs" rows="12" by="desc"}
       <a href="{$rs.url}" target="_blank">
		<div class="listitem">
				<div class="text"><em>{$i}</em>{$rs.title|get_word=64}
				{if $rs.list>time()}<span class="ding">顶</span>{/if}
				{if (time()-$rs.create_time<3600*24)}
				<span class="new">新</span>
				{/if}
				{gt name="rs.view" value="200"}<span class="hot">热</span>{/gt}
				{eq name="rs.status" value="2"}<span class="jing">精</span>{/eq}
				</div>
			<div class="others">
				 <div class="left">
					<p><i class="fa fa-clock-o"></i>{$rs.create_time|format_time="Y-m-d"}</p>
					<p><i class="si si-user"></i>回复: {$rs.replyuser|default='无'}<em>{$rs.update_time|format_time=true}</em></p>
				 </div>
				  <div class="right">
				  	<p><i class="si si-bubbles"></i>{$rs.replynum}评论</p>
					<p style="border-right:0;"><i class="si si-eye"></i>{$rs.view}</阅读</p>
				</div>
				</div>
		</div>
	</a>
	{/qb:tag}
    </div>
</div>

   <div class="member-moban">
 <div class="Contents2 member-bbslist pc_member_homepage_dev003" style="display:none;">
       {qb:tag name="pc_member_homepage_dev003" js="pc_member_homepage_dev003" union="uid" class="app\bbs\model\Content@get_reply_label" rows="12" by="desc"}
       <a href="{$rs.url}" target="_blank">
		<div class="listitem">
				<div class="text"><em>{$i}</em>{$rs.title|get_word=64}
				{if $rs.list>time()}<span class="ding">顶</span>{/if}
				{if (time()-$rs.create_time<3600*24)}
				<span class="new">新</span>
				{/if}
				{gt name="rs.view" value="200"}<span class="hot">热</span>{/gt}
				{eq name="rs.status" value="2"}<span class="jing">精</span>{/eq}
				</div>
			<div class="others">
				 <div class="left">
					<p><i class="fa fa-clock-o"></i>{$rs.create_time|format_time="Y-m-d"}</p>
					<p><i class="si si-user"></i>回复: {$rs.replyuser|default='无'}<em>{$rs.update_time|format_time=true}</em></p>
				 </div>
				  <div class="right">
				  	<p><i class="si si-bubbles"></i>{$rs.replynum}评论</p>
					<p style="border-right:0;"><i class="si si-eye"></i>{$rs.view}</阅读</p>
				</div>
				</div>
		</div>
	  </a>
	{/qb:tag}
    </div>
</div>
    <div class="Contents2 user-infomation" style="display:none;width:950px;padding:25px;">
     <dl>
     	<dt>基本信息</dt>
     	<dd>
     		<p><em>昵称</em></p>
     		<span>{$info.nickname}</span>
     	</dd>
     	<dd><p>UID</p><span>{$info.uid}</span></dd>
     	<dd><p>级别</p><span>{$info.groupid|getGroupByid}</span></dd>
		{if modules_config('bbs')}<dd><p>总共发贴</p><span>{:fun('bbs@mytotal',$info.uid)} 篇</span></dd>{/if}
		<dd><p>积分</p><span>{$info.money}</span></dd>
		<dd><p>可用余额</p><span>{$info.rmb}</span></dd>
		<dd><p>冻结余额</p><span>{$info.rmb_freeze}</span></dd>
     	<dd><p>性别</p><span>{switch $info.sex}{case 1}男{/case}{case 2}女{/case}{default /}保密{/switch}</span></dd>
		<dd><p>注册日期</p><span>{:date("Y-m-d H:i:s",$info.regdate)}</span></dd>
		<dd><p>最后登录</p><span>{:date("Y-m-d H:i:s",$info.lastvist)}</span></dd>
     	<dd><p>简介</p><span>{$info.introduce}</span></dd>
     </dl>
     <dl class="user-ziliao">
     	<dt>联系方式</dt>
     	<dd><p>QQ</p><span>{$info.oicq}</span></dd>
     	<dd><p>微信</p><span>{$info.telphone}</span></dd>
     </dl>
    </div>
 
</div>
  </div>
<!--列表结束---->
<script type="text/javascript">
var type_num = 0; //默认是第一项
$(document).ready(function () {
	$(".Showtab span").click(function(){
		$(".Showtab span").removeClass('ck');
		$(this).addClass('ck');
		type_num = $(this).index();		
		$(".ContentType-box .Contents2").hide();
		$(".ContentType-box .Contents2").eq(type_num).show();
		if(type_num==3){
			scroll_get = false;
			return ;
		}
		scroll_get = true;	//避免其它加载完了,这里却无法加载
	});
});

var Mpage = new Array();	//页码数组
var urldb = new Array('{qb:url name="pc_member_homepage_dev001" /}','{qb:url name="pc_member_homepage_dev002" /}','{qb:url name="pc_member_homepage_dev003" /}'); //不同的URL
function ShowMoreBBs(){
	if( typeof Mpage[type_num]=='undefined' ){
		Mpage[type_num] = 1;
	}
	Mpage[type_num]++;
	var url = urldb[type_num] + Mpage[type_num];
	
	$.get(url,function(res){
		if(res.code==0){
			if(res.data==''){
				layer.msg("已经显示完了！",{time:500});
			}else{
				$(".ContentType-box .Contents2").eq(type_num).append(res.data);
				set_i_num();
				scroll_get = true;
			}
		}else{
			layer.msg(res.msg,{time:2500});
		}
	});
}

//滚动显示更多
var scroll_get = true;	//做个标志,不要反反复复的加载
$(document).ready(function () {
	$(window).scroll(function () {
		if (scroll_get==true &&  (400 + $(window).scrollTop())>($(document).height() - $(window).height())) {
			scroll_get = false;
			layer.msg('内容加截中,请稍候',{time:1000});
			ShowMoreBBs();
		}
	});
});

//设置标题序号
function set_i_num(){
	var j = 0;
	$(".ContentType-box .Contents2").eq(type_num).find(".text em").each(function(){
		j++;
		$(this).html(j);
	});
}


</script>


<script type="text/javascript" src="__STATIC__/js/qibo.js"></script>

</div>
</body>
</html>